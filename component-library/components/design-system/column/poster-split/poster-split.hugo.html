{{ $src := .image }}

{{ if not site.Params.env_bookshop_live }}
  {{ $image := "" }}
  {{/*  Get the image, either from its remote or local source  */}}
  {{ if hasPrefix $src "http"}}
    {{ $image = resources.GetRemote .image }}
  {{ else }}
    {{ $image = resources.Get .image }}
  {{ end }}

  {{/* Resize images and add them to a variable  */}}
  {{ if and $image (ne $image.MediaType.SubType "svg") }}{{ $src = ($image.Fill "960x640 webp").RelPermalink }}{{ end }}
{{ end }}

<div class="h-100 wvu-b-shadow wvu-b-border wvu-b-subtle audience-{{ .settings.styles.audience }} tone-{{ .settings.styles.tone }} bg-{{ .settings.styles.color_palette }} position-relative">
  <div class="row">
    <div class="col-lg-12 order-2 order-lg-1">
      <div class="p-5 wvu-z-index-content">
        <div class="wvu-p-max-width wvu-z-index-content">
          <h2 id="-label" class="h1 wvu-b-display-heading wvu-b-accent-text mb-3" data-text="{{ .heading }}"><span class="wvu-b-font-adjust">{{ .heading }}</span></h2>

          {{ with .subheading }}
            <p class="h5 wvu-b-subheading py-1">
              <span class="wvu-b-font-adjust">{{ . }}</span>
            </p>
          {{ end }}
  
          {{ with .body }}
            <div class="mb-4">
              {{ . | markdownify }}
            </div>
          {{ end }}
  
          {{ with .ctas }}
            <p class="mb-0">
              {{ range . }}
                <a class="btn wvu-b-btn btn-sm mb-1 me-1" href="{{ .url }}">{{ .text }} {{ with .icon }}<span class="fa-regular fa-{{ . }}"></span>{{ end }}</a>
              {{ end }}
            </p>
          {{ end }}

          {{ if .postscript_links }}
            {{ if not site.Params.env_bookshop_live }}
              <p class="mt-3">
                {{- range $i, $l := .postscript_links }}
                  {{- if gt $i 0 }} | {{- end }}
                  <a class="text-decoration-none" href=".url">{{ .text }}{{ if .icon }} <span class="fa-solid fa-{{ .icon }}"></span>{{ end }}</a>
                {{ end }}
              </p>
            {{ else }}
              <p class="mt-3">
                {{- range .postscript_links }}
                  <a class="text-decoration-none small" href=".url">{{ .text }}{{ if .icon }} <span class="fa-solid fa-{{ .icon }}"></span>{{ end }}</a>
                {{ end }}
              </p>
            {{ end }}
          {{ end }}
        </div>
      </div>
    </div>
    <div class="col-lg-12 order-1 order-lg-2">
      <div class="position-relative wvu-z-index-content h-100">
        <img class="mw-100 d-lg-none" src="{{ $src }}" />
        <div class="wvu-bg-img d-none d-lg-block">
          {{ if $src }}
            <img class="object-fit-cover h-100 w-100" src="{{ $src }}" {{ if .alt_text }}alt="{{ .alt_text }}"{{ end }} />
          {{ end }}
        </div>
      </div>
    </div>
  </div>
</div>